(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{},prefix:""};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,b){try{localStorage.setItem(a,b)}catch(c){}};lsloader.getLS=function(a){var b="";try{b=localStorage.getItem(a)}catch(c){b=""}return b};lsloader.load=function(a,b,c){c=c||function(){};var d;d=this.getLS(a);if(/\|codestartv1\|/.test(d))if(d){var e=d.split("|codestartv1|")[0];e!=b?(this.removeLS(a),this.requestResource(a, b,c)):(d=d.split("|codestartv1|")[1],/\.js$/.test(e)?(this.jsRunSequence.push({name:a,code:d}),this.runjs(b,a,d)):(document.getElementById(a).appendChild(document.createTextNode(d)),c()))}else this.requestResource(a,b,c);else this.removeLS(a),this.requestResource(a,b,c)};lsloader.requestResource=function(a,b,c){var d=this;/\.js$/.test(b)?this.iojs(b,a,function(a,b,c){d.setLS(b,a+"|codestartv1|"+c);d.runjs(a,b,c)}):/\.css$/.test(b)&&this.iocss(b,a,function(c){document.getElementById(a).appendChild(document.createTextNode(c)); d.setLS(a,b+"|codestartv1|"+c)},c)};lsloader.iojs=function(a,b,c){var d=this;d.jsRunSequence.push({name:b,code:""});try{var e=new XMLHttpRequest;e.open("get",a,!0);e.onreadystatechange=function(){4==e.readyState&&((200<=e.status&&300>e.status||304==e.status)&&""!=e.response?c(a,b,e.response):d.jsfallback(a,b))};e.send(null)}catch(f){d.jsfallback(a,b)}};lsloader.iocss=function(a,b,c,d){var e=this;try{var f=new XMLHttpRequest;f.open("get",a,!0);f.onreadystatechange=function(){4==f.readyState&&((200<= f.status&&300>f.status||304==f.status)&&""!=f.response?(c(f.response),d()):e.cssfallback(a,b,d))};f.send(null)}catch(k){e.cssfallback(a,b,d)}};lsloader.runjs=function(a,b,c){if(b&&c)for(var d in this.jsRunSequence)this.jsRunSequence[d].name==b&&(this.jsRunSequence[d].code=c);if(this.jsRunSequence[0]&&this.jsRunSequence[0].code&&"failed"!=this.jsRunSequence[0].status)a=document.createElement("script"),b=document.getElementsByTagName("script")[0],a.appendChild(document.createTextNode(this.jsRunSequence[0].code+ "\n //# sourceURL="+this.jsRunSequence[0].name)),b.parentNode.insertBefore(a,b),this.jsRunSequence.shift(),0<this.jsRunSequence.length&&this.runjs();else if(this.jsRunSequence[0]&&"failed"==this.jsRunSequence[0].status){var e=this;a=document.createElement("script");a.src=this.jsRunSequence[0].path;this.jsRunSequence[0].status="loading";a.onload=function(){e.jsRunSequence.shift();0<e.jsRunSequence.length&&e.runjs()};b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}};lsloader.tagLoad= function(a,b){this.jsRunSequence.push({name:b,code:"",path:a,status:"failed"});this.runjs()};lsloader.jsfallback=function(a,b){if(!this.jsnamemap[b]){this.jsnamemap[b]=b;for(var c in this.jsRunSequence)this.jsRunSequence[c].name==b&&(this.jsRunSequence[c].code="",this.jsRunSequence[c].status="failed",this.jsRunSequence[c].path=a);this.runjs()}};lsloader.cssfallback=function(a,b,c){this.cssnamemap[b]||(this.cssnamemap[b]=1,b=document.createElement("link"),b.type="text/css",b.href=a,b.rel="stylesheet", b.onload=b.onerror=c,a=document.getElementsByTagName("script")[0],a.parentNode.insertBefore(b,a))};lsloader.runInlineScript=function(a,b){b=document.getElementById(b).innerText;this.jsRunSequence.push({name:a,code:b});this.runjs()};lsloader.loadCombo=function(a){var b="",c={},d;for(d in a){var e=this.getLS(a[d].name);if(e)var f=e.split("|codestartv1|")[0],k=e.split("|codestartv1|")[1];else f="";f==a[d].path?this.jsRunSequence.push({name:a[d].name,code:k,path:a[d].path}):(this.jsRunSequence.push({name:a[d].name, code:null,path:a[d].path,status:"comboloading"}),c[a[d].name]=!0,b+=(""==b?"":",")+a[d].path)}var h=this;if(b){var g=new XMLHttpRequest;g.open("get",this.prefix+b,!0);g.onreadystatechange=function(){if(4==g.readyState)if(200<=g.status&&300>g.status||304==g.status)""!=g.response&&h.runCombo(g.response,c);else{for(var a in h.jsRunSequence)c[h.jsRunSequence[a].name]&&(h.jsRunSequence[a].status="failed");h.runjs()}};g.send(null)}this.runjs()};lsloader.runCombo=function(a,b){a=a.split(/\;\/\*combojs\*\//); a.shift();for(var c in this.jsRunSequence)b[this.jsRunSequence[c].name]&&a[0]&&(this.jsRunSequence[c].status="comboJS",this.jsRunSequence[c].code=a[0],this.setLS(this.jsRunSequence[c].name,this.jsRunSequence[c].path+"|codestartv1|"+a[0]),a.shift());this.runjs()}})();
